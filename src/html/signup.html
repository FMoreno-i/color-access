<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ColorAccess - Registro</title>

  <link rel="stylesheet" href="../css/styles.css" />
  <link rel="stylesheet" href="../css/color-modes.css" />

  <!-- Solo mejora foco visible (sin cambiar layout) -->
  <style>
    :focus-visible{
      outline: 3px solid rgba(0,0,0,.75);
      outline-offset: 3px;
      border-radius: 10px;
    }
    .password-toggle:focus-visible{
      outline-offset: 6px;
    }
  </style>
</head>

<body class="color-mode-normal">
<div class="container">

  <!-- Skip link (no cambia diseño; aparece solo al tab) -->
  <a href="#main" class="skip-link" style="
      position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden;
    "
     onfocus="this.style.left='12px';this.style.top='12px';this.style.width='auto';this.style.height='auto';this.style.padding='10px 12px';this.style.background='#fff';this.style.border='2px solid rgba(0,0,0,.35)';this.style.borderRadius='12px';this.style.zIndex='9999';"
     onblur="this.style.left='-999px';this.style.width='1px';this.style.height='1px';this.style.padding='0';"
  >
    Saltar al formulario
  </a>

  <header class="header">
    <h1 class="app-title">ColorAccess</h1>
    <p class="app-subtitle">Aplicación para detección y apoyo en daltonismo</p>
  </header>

  <main class="main-content" id="main" tabindex="-1">
    <div class="login-card">
      <h2>Crear Cuenta</h2>

      <!-- Región para mensajes (éxito/error) -->
      <div id="formStatus" class="sr-only" aria-live="polite" aria-atomic="true"
           style="position:absolute; left:-999px; width:1px; height:1px; overflow:hidden;"></div>

      <form class="login-form" id="signup-form" novalidate aria-describedby="formHelp">
        <p id="formHelp" style="margin-top:0; color:rgba(0,0,0,.65); font-weight:700;">
          Completa los campos. Puedes navegar con TAB y enviar con Enter.
        </p>

        <div class="form-group">
          <label for="fullname">Nombre completo:</label>
          <input
                  type="text"
                  id="fullname"
                  name="fullname"
                  placeholder="Juan Pérez"
                  required
                  autocomplete="name"
                  aria-required="true"
          />
        </div>

        <div class="form-group">
          <label for="email">Correo:</label>
          <input
                  type="email"
                  id="email"
                  name="email"
                  placeholder="correo@ejemplo.com"
                  required
                  autocomplete="email"
                  inputmode="email"
                  aria-required="true"
          />
        </div>

        <div class="form-group">
          <label for="username">Usuario:</label>
          <input
                  type="text"
                  id="username"
                  name="username"
                  placeholder="Jugador"
                  required
                  autocomplete="username"
                  aria-required="true"
          />
        </div>

        <div class="form-group">
          <label for="daltonismType">Tipo de daltonismo:</label>

          <!-- Importante: el select es accesible por defecto; solo aseguramos foco -->
          <div class="select-wrapper" id="daltonismWrapper">
            <select
                    id="daltonismType"
                    name="daltonismType"
                    class="select-field"
                    required
                    aria-required="true"
            >
              <option value="normal">Normal (sin daltonismo)</option>
              <option value="deuteranopia">Deuteranopía</option>
              <option value="protanopia">Protanopía</option>
              <option value="tritanopia">Tritanopía</option>
              <option value="unknown">No lo sé / Prefiero no decir</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="password">Contraseña:</label>

          <div class="password-field">
            <input
                    type="password"
                    id="password"
                    name="password"
                    placeholder="******"
                    minlength="6"
                    required
                    autocomplete="new-password"
                    aria-required="true"
                    aria-describedby="passHelp"
            />

            <!-- aria-pressed + aria-controls para lectores -->
            <button
                    type="button"
                    class="password-toggle"
                    data-target="password"
                    aria-label="Mostrar contraseña"
                    aria-pressed="false"
                    aria-controls="password"
            >
              <svg class="icon-eye" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
                <path d="M12 5C6.5 5 2 12 2 12s4.5 7 10 7 10-7 10-7-4.5-7-10-7Zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10Zm0-2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"></path>
              </svg>

              <svg class="icon-eye-off" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" style="display:none;">
                <path d="M2 4.27 3.28 3 21 20.72 19.73 22l-2.2-2.2A10.94 10.94 0 0 1 12 21C6.5 21 2 14 2 14s1.21-1.88 3.34-3.73L2 4.27ZM12 19c1.35 0 2.6-.3 3.73-.82l-1.62-1.62c-.64.28-1.34.44-2.11.44a5 5 0 0 1-5-5c0-.77.16-1.47.44-2.11L5.9 8.27C4.13 9.72 3.05 11.5 3.05 11.5S6.5 19 12 19Zm9.95-5S20.79 12.12 18.66 10.27L16.5 8.11A10.94 10.94 0 0 0 12 7c-.78 0-1.52.08-2.22.23L8.12 5.57A12.5 12.5 0 0 1 12 5c5.5 0 9.95 7 9.95 7ZM12 9a5 5 0 0 1 5 5c0 .37-.04.73-.12 1.07l-1.7-1.7c.02-.12.03-.24.03-.37A2.5 2.5 0 0 0 12 10.5c-.13 0-.25.01-.37.03l-1.7-1.7C10.27 9.04 10.63 9 11 9Z"></path>
              </svg>
            </button>
          </div>

          <div id="passHelp" style="margin-top:6px; color:rgba(0,0,0,.65); font-weight:700;">
            Minimo 6 caracteres.
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirmar contraseña:</label>

          <div class="password-field">
            <input
                    type="password"
                    id="confirmPassword"
                    name="confirmPassword"
                    placeholder="******"
                    minlength="6"
                    required
                    autocomplete="new-password"
                    aria-required="true"
                    aria-describedby="confirmHelp"
            />

            <button
                    type="button"
                    class="password-toggle"
                    data-target="confirmPassword"
                    aria-label="Mostrar contraseña"
                    aria-pressed="false"
                    aria-controls="confirmPassword"
            >
              <svg class="icon-eye" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
                <path d="M12 5C6.5 5 2 12 2 12s4.5 7 10 7 10-7 10-7-4.5-7-10-7Zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10Zm0-2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"></path>
              </svg>

              <svg class="icon-eye-off" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" style="display:none;">
                <path d="M2 4.27 3.28 3 21 20.72 19.73 22l-2.2-2.2A10.94 10.94 0 0 1 12 21C6.5 21 2 14 2 14s1.21-1.88 3.34-3.73L2 4.27ZM12 19c1.35 0 2.6-.3 3.73-.82l-1.62-1.62c-.64.28-1.34.44-2.11.44a5 5 0 0 1-5-5c0-.77.16-1.47.44-2.11L5.9 8.27C4.13 9.72 3.05 11.5 3.05 11.5S6.5 19 12 19Zm9.95-5S20.79 12.12 18.66 10.27L16.5 8.11A10.94 10.94 0 0 0 12 7c-.78 0-1.52.08-2.22.23L8.12 5.57A12.5 12.5 0 0 1 12 5c5.5 0 9.95 7 9.95 7ZM12 9a5 5 0 0 1 5 5c0 .37-.04.73-.12 1.07l-1.7-1.7c.02-.12.03-.24.03-.37A2.5 2.5 0 0 0 12 10.5c-.13 0-.25.01-.37.03l-1.7-1.7C10.27 9.04 10.63 9 11 9Z"></path>
              </svg>
            </button>
          </div>

          <div id="confirmHelp" style="margin-top:6px; color:rgba(0,0,0,.65); font-weight:700;">
            Debe coincidir con la contrasena.
          </div>
        </div>

        <button type="submit" class="login-button" aria-label="Registrarme">
          Registrarme
        </button>
      </form>

      <div class="register-link">
        <p>¿Ya tienes cuenta? <a href="login.html">Inicia sesión</a></p>
      </div>
    </div>
  </main>

  <footer class="footer">
    <p>&copy; 2026 ColorAccess - Aplicación para accesibilidad visual</p>
  </footer>
</div>

<script src="../js/color-manager.js"></script>
<script src="../js/signup.js"></script>

<!-- Pequeño helper opcional (sin tocar tu signup.js):
     mejora ARIA del botón ojo cuando cambia (si tu signup.js no lo hace).
     Si ya lo manejas en JS, puedes borrar este bloque. -->
<script>
  document.addEventListener("click", (e) => {
    const btn = e.target.closest?.(".password-toggle");
    if (!btn) return;

    // Solo ajusta ARIA según el input (no altera tu lógica de toggle)
    const targetId = btn.getAttribute("data-target");
    const input = document.getElementById(targetId);
    if (!input) return;

    // Esperar al siguiente frame por si signup.js cambia type
    requestAnimationFrame(() => {
      const isShown = input.type === "text";
      btn.setAttribute("aria-pressed", String(isShown));
      btn.setAttribute("aria-label", isShown ? "Ocultar contraseña" : "Mostrar contraseña");
    });
  });
</script>
</body>
</html>
